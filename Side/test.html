<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Google Sheets Data</title>
</head>
<body>

<div id="dataDisplay"></div>

<script>
const httpRequest = new XMLHttpRequest();
var urls = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRZO5_Xb0jVltZCUnjJVOqE4d1q08pLnZugLRKJgChzBQqsCDbeIJKWRcm0Dy1bovTgOXHS7o8dnYlH/pub?gid=0&single=true&output=csv'
httpRequest.open('GET',urls, true)
httpRequest.send()

//切割成list of dict
httpRequest.onreadystatechange = function () {
    if (httpRequest.readyState == 4 && httpRequest.status == 200) {
        var tags_csv = httpRequest.responseText
        tags_csv = tags_csv.split('\n')
        for(var i=0;i<tags_csv.length;i++){
            tags_csv[i] = tags_csv[i].substring(0, tags_csv[i].length-1)
            tags_csv[i] = tags_csv[i].split(',')
        }
        tags_list = []
        for(var i=1;i<tags_csv.length;i++){
            tags_list[i-1] = {}
            for(var j=0;j<tags_csv[i].length;j++){
                tags_list[i-1][tags_csv[0][j]] = tags_csv[i][j]
            }
        }
        console.log(tags_list);
    }
};
</script>

</body>
</html>
