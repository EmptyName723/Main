<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Google Sheets Data</title>
</head>
<body>

<div id="dataDisplay"></div>

<script>
var url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRZO5_Xb0jVltZCUnjJVOqE4d1q08pLnZugLRKJgChzBQqsCDbeIJKWRcm0Dy1bovTgOXHS7o8dnYlH/pubhtml';

// Function to fetch Google Sheet data
function fetchGoogleSheetData(sheetID, callback) {
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4 && xhr.status == 200) {
            var data = JSON.parse(xhr.responseText);
            var entries = data.feed.entry;
            var dataArray = [];

            entries.forEach(function(entry) {
                var rowObject = {};
                for (var key in entry) {
                    if (key.startsWith('gsx$')) {
                        var cellValue = entry[key].$t;
                        var formattedKey = key.replace('gsx$', '');
                        rowObject[formattedKey] = cellValue;
                    }
                }
                dataArray.push(rowObject);
            });

            callback(dataArray);
        }
    };
    xhr.open('GET', url, true);
    xhr.send();
}

// Function to display data as a JavaScript array in an HTML object
function displayData(dataArray) {
    var html = '<pre>' + JSON.stringify(dataArray, null, 2) + '</pre>';
    document.getElementById('dataDisplay').innerHTML = html;
}

// Fetch Google Sheet data and display it
fetchGoogleSheetData(url, displayData);
</script>

</body>
</html>
